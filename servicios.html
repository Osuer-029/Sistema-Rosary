<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Servicios — Heladería Rosary</title>
<link rel="stylesheet" href="servicios.css">

<!-- ✅ Librería jsPDF para generar PDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
<header>
  <h1>📅 Servicios</h1>
  <a href="app.html" id="btn-volver" class="boton-volver">🏠 Volver</a>
  <button id="btn-estado-cuenta">💳 Estado de Cuenta</button>
  
</header>

<main>
  <section class="formulario">
    <h2>Agregar Cliente</h2>
    <input type="text" id="nombre" placeholder="Nombre del cliente">
    <input type="email" id="correo" placeholder="Correo electrónico">
    <input type="tel" id="telefono" placeholder="Teléfono">
    <input type="date" id="fechaEntrada" placeholder="Fecha de ingreso (Próx. Corte)">
    <input type="number" id="monto" placeholder="Monto mensual (ej: 150.00)">

    <label for="servicio">Servicio</label>
    <select id="servicio">
      <option value="Netflix">🎬 Netflix</option>
      <option value="Spotify">🎵 Spotify</option>
      <option value="HBO">📺 HBO Max</option>
      <option value="Disney+">🧞 Disney+</option>
      <option value="Amazon Prime">🚀 Amazon Prime</option>
      <option value="Otro">🧩 Otro</option>
    </select>

    <label for="tipo-servicio">Tipo de servicio</label>
    <select id="tipo-servicio">
    <option value="Tv">📺 Tv</option>
    <option value="celular">📱 celular</option>
    </select>


    <button id="btn-agregar">Agregar Servicio</button>
  </section>

  <section class="lista-clientes">
    <h2>Clientes Registrados</h2>
<div class="buscador-container">
    <input type="text" id="buscador-input" placeholder="Buscar cliente, servicio o tipo de servicio...">
    <button id="btn-buscar">Buscar</button> 
</div>
    <div id="clientes-lista"></div>
  </section>
</main>

<!-- MODAL EDITAR CLIENTE -->
<div id="modal-editar" class="modal">
  <div class="modal-content">
    <h3>✏️ Editar Cliente</h3>
    <input type="text" id="editar-nombre" placeholder="Nombre">
    <input type="email" id="editar-correo" placeholder="Correo electrónico">
    <input type="tel" id="editar-telefono" placeholder="Teléfono">
    <input type="date" id="editar-fechaEntrada" placeholder="Fecha de ingreso (Próx. Corte)">
    <input type="number" id="editar-monto" placeholder="Monto mensual">
    <select id="editar-servicio">
      <option value="Netflix">🎬 Netflix</option>
      <option value="Spotify">🎵 Spotify</option>
      <option value="HBO">📺 HBO Max</option>
      <option value="Disney+">🧞 Disney+</option>
      <option value="Amazon Prime">🚀 Amazon Prime</option>
      <option value="Otro">🧩 Otro</option>

      
    </select>

    <div class="modal-btns">
      <button id="guardar-edicion">💾 Guardar</button>
      <button id="cancelar-edicion">❌ Cancelar</button>
    </div>
  </div>
</div>

<!-- MODAL REGISTRAR PAGO -->
<div id="modal-pago" class="modal">
  <div class="modal-content">
    <h3>✅ Registrar Pago de <span id="pago-cliente-nombre">Cliente</span></h3>
    <label for="pago-monto">Monto Pagado</label>
    <input type="number" id="pago-monto" placeholder="Monto">
    
    <label for="pago-fecha">Fecha del Pago</label>
    <input type="date" id="pago-fecha">

    <label for="pago-meses">Meses Pagados</label>
    <input type="number" id="pago-meses" value="1" min="1">
    
    <label for="pago-metodo">Método de Pago</label>
    <select id="pago-metodo">
      <option value="Efectivo">💵 Efectivo</option>
      <option value="Transferencia">🏦 Transferencia</option>
      <option value="Tarjeta">💳 Tarjeta (POS)</option>
    </select>
    
    <div class="modal-btns">
      <button id="btn-registrar-pago">✔️ Confirmar Pago</button>
      <button id="btn-cancelar-pago">❌ Cancelar</button>
    </div>
  </div>
</div>

<!-- MODAL HISTORIAL DE PAGOS -->
<div id="modal-pagos-historial" class="modal">
  <div class="modal-content">
    <h3 id="historial-cliente-nombre">Historial de Pagos de Cliente</h3>
    <p style="font-size: 0.9em; color: #e74c3c;">
        * Usa "Eliminar y Revertir" solo si un pago se registró por error.
    </p>
    <div id="historial-lista"></div>
    <div class="modal-btns">
      <button id="btn-cerrar-historial">Cerrar</button>
    </div>
  </div>
</div>

<!-- MODAL ESTADO DE CUENTA -->
<div id="modal-estado-cuenta" class="modal">
  <div class="modal-content">
    <h3>💳 Estado de Cuenta</h3>
    <div style="margin-bottom: 1rem;">
      <label for="fecha-desde">Desde:</label>
      <input type="date" id="fecha-desde">
      <label for="fecha-hasta">Hasta:</label>
      <input type="date" id="fecha-hasta">
      <button id="btn-filtrar-fechas">Filtrar</button>
    </div>
    <div id="estado-cuenta-lista" style="max-height: 60vh; overflow-y: auto;"></div>
    <div style="margin-top:1rem; font-weight:bold;" id="total-cobrar"></div>
    <div class="modal-btns">
      <button id="btn-cerrar-estado-cuenta">Cerrar</button>
    </div>
  </div>
</div>

<!-- MODAL FACTURA -->
<div id="modal-factura" class="modal">
  <div class="modal-content">
    <div id="factura-contenido"></div>
    <div class="modal-btns">
      <button id="btn-imprimir-pdf">🖨️ Imprimir / PDF</button>
      <button id="btn-cerrar-factura">❌ Cerrar</button>
    </div>
  </div>
</div>

<script type="module" src="servicios.js"></script>

<script>
    document.getElementById("btn-volver").addEventListener("click", () => {
        window.close();
    });
  </script>
</body>
</html>
